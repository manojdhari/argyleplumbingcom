# rss_generate_only.py

import os
import pandas as pd
from datetime import datetime

EXCEL_FILE = "local_seo_pages.xlsx"
OUTPUT_DIR = "generated_sites"
cities_df = pd.read_excel(EXCEL_FILE, sheet_name="Cities")
settings = pd.read_excel(EXCEL_FILE, sheet_name="Settings").iloc[0].to_dict()

rss_path = os.path.join(OUTPUT_DIR, "rss.xml")
rss_items = []

for state in sorted(cities_df['state'].unique()):
    url = f"https://{state.lower()}.{settings['domain']}/"
    rss_items.append(f"""  <item>
    <title>{state} Plumbing</title>
    <link>{url}</link>
    <description>Serving all major cities in {state}</description>
    <pubDate>{datetime.now().strftime('%a, %d %b %Y %H:%M:%S +0000')}</pubDate>
  </item>""")

rss_feed = f"""<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
  <channel>
    <title>{settings['domain']} RSS Feed</title>
    <link>https://{settings['domain']}/</link>
    <description>Index of all State Plumbing Pages</description>
{''.join(rss_items)}
  </channel>
</rss>
"""

with open(rss_path, "w", encoding="utf-8") as f:
    f.write(rss_feed.strip())

print("âœ… RSS.XML created successfully.")
